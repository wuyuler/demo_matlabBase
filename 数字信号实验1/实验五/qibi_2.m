%切必雪夫原型
%脉冲响应不变法
fs=8000;
ws1=0.3*pi*fs;ws2=0.8*pi*fs;
wp1=0.45*pi*fs;wp2=0.65*pi*fs;
ws=[ws1 ws2];wp=[wp1 wp2]; 
Rp=1;Rs=40;
[N,Wn]=cheb1ord(wp,ws,Rp,Rs,'s');
[num,den]=cheby1(N,1,Wn,'s');
[B,A]=impinvar(num,den,8000);
[h,w]=freqz(B,A);
f=w/pi*4000;
subplot(2,1,1);
plot(f,20*log10(abs(h)));
axis([0,4000,-90,10]);
grid;
xlabel('频率/Hz');ylabel('幅度/dB');
subplot(2,1,2);
plot(f,angle(h));
grid;
xlabel('频率/Hz');ylabel('相位');
